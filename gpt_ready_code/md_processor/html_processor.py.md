"html_processor.py": "'import os\nimport re\nimport time\nimport urllib.parse\n# import aspose.words as aw\nimport subprocess\nfrom typing import Optional\nimport glob\ndef convert_html_to_md(input_directory=None, output_directory=None):\n\tif input_directory is None:\n\t\tinput_directory = os.getcwd()\n\tif output_directory is None:\n\t\toutput_directory = os.path.join(input_directory, "md")\n\ttry:\n\t\t# Create the output directory if it does not exist\n\t\tos.makedirs(output_directory, exist_ok=True)\n\t\t# List all files in the input directory\n\t\tfiles = [f for f in os.listdir(input_directory) if f.endswith(\'.html\')]\n\t\tfor file in files:\n\t\t\tinput_file = os.path.join(input_directory, file)\n\t\t\toutput_file = os.path.join(\n\t\t\t\toutput_directory, file.replace(\'.html\', \'.md\'))\n\t\t\t# Convert HTML to Markdown and extract images\n\t\t\tsubprocess.run([\'pandoc\', \'--extract-media=\' + output_directory,\n\t\t\t\t\t\t   input_file, \'-o\', output_file], check=True)\n\t\tprint(\n\t\t\tf\'Successfully converted HTML files to Markdown in {output_directory}\')\n\texcept subprocess.CalledProcessError as e:\n\t\tprint(f\'Failed to convert HTML to Markdown: {e}\')\n\texcept Exception as e:\n\t\tprint(f\'An error occurred: {e}\')\ndef change_html_title(path: Optional[str] = None) -> None:\n\t"""\n\tChange the title of all HTML files in the specified directory to match their filenames.\n\tParameters:\n\tpath (str): The directory to search for HTML files. Defaults to the current working directory.\n\tReturns:\n\tNone\n\t"""\n\tif path is None:\n\t\tpath = os.getcwd()\n\tfiles = glob.glob(os.path.join(path, \'*.html\'))\n\tfor file in files:\n\t\tinput_file = os.path.join(path, file)\n\t\tinput_file = input_file.replace(\'\\\\\', \'/\')\n\t\tif os.path.exists(input_file) and os.path.isfile(input_file):\n\t\t\ttry:\n\t\t\t\twith open(input_file, \'r\', encoding="utf-8") as f:\n\t\t\t\t\tcontent = f.read()\n\t\t\t\treg_string = r\'<title>.*?</title>\'\n\t\t\t\tcontent = re.sub(\n\t\t\t\t\treg_string, f\'<title>{os.path.splitext(os.path.basename(file))[0]}</title>\', content)\n\t\t\t\twith open(input_file, \'w\', encoding="utf-8") as f:\n\t\t\t\t\tf.write(content)\n\t\t\texcept Exception as e:\n\t\t\t\tprint(f"An error occurred while processing {input_file}: {e}")\n\t\telse:\n\t\t\tprint(f"File {input_file} does not exist or is not accessible.")\ndef html2md(path=None, output_root="C://Output//", output_folder_name=None):\n\tif path is None:\n\t\tpath = os.getcwd()\n\ttimestamp = int(time.time())\n\tintput_path = path\n\tinput_floder_name = os.path.basename(intput_path)\n\t# replace_list_regex2=[[r\'Part \\d{2}-Module \\d{2}-Lesson (\\d{2})_(.+)\',r\'0\\1_\\2\'],]\n\tinput_floder_name = re.sub(\n\t\tr\'Part \\d{2}-Module \\d{2}-Lesson (\\d{2})_(.+)\', r\'0\\1_\\2\', input_floder_name)\n\t# Part 01-Module 01-Lesson 01_Welcome to the C++ Developer Nanodegree Program\n\tinput_floder_name = input_floder_name.replace(" ", "_")\n\toutput_path = os.path.join(\n\t\toutput_root, output_folder_name, input_floder_name)\n\tos.makedirs(output_path, exist_ok=True)\n\tlistfiles = os.listdir(intput_path)\n\tmp4_list = [\n\t\tfilename for filename in listfiles if filename.endswith(".mp4")]\n\t# print(listfiles)\n\tfor i in range(len(listfiles)):\n\t\tfilename = listfiles[i]  # get all file list\n\t\tif filename.endswith(".html"):\n\t\t\tinput_file = os.path.join(intput_path, filename)\n\t\t\tdoc = aw.Document(input_file)\n\t\t\toutput_file = os.path.join(\n\t\t\t\toutput_path, filename.replace(".html", ".md"))\n\t\t\t# print(output_path)\n\t\t\tdoc.save(output_file)\n\toutput_files_list = os.listdir(output_path)\n\treplace_list_regex = [[r\'!\\[\\]\\(.+\\.001\\.png\\)\', r\'\'],\n\t\t\t\t\t\t  [r\'(!\\[\\]|!\\[.+\\])(\\(.+)(\\.png|\\.jpg|\\.gif|\\.jpeg|\\.svg|\\.wbem)\\)\',\n\t\t\t\t\t\t\t  r\'\\1\\2\'+f\'_{timestamp}\'+r\'\\3)\'],\n\t\t\t\t\t\t  [r\'\\*\\*Evaluation Only\\. Created with Aspose\\.Words\\. Copyright 2003-2023 Aspose Pty Ltd\\.\\*\\*\', r\'\'],\n\t\t\t\t\t\t  [r\'\\*\\*Created with an evaluation copy of Aspose.Words. To discover the full versions of our APIs please visit: https://products.aspose.com/words/\\*\\*\', r\'\'],\n\t\t\t\t\t\t  [r\'\\[udacimak v1.4.1\\]\\(https://github.com/udacimak/udacimak#readme\\)\', r\'\'],\n\t\t\t\t\t\t  [r\'\\[.+\\]\\(.+\\.html\\)\', r\'\'],\n\t\t\t\t\t\t  [r\'\\n{3,}\', r\'\\n\\n\'],\n\t\t\t\t\t\t  [r\'`[ ]+`\', r\'\t\'],\n\t\t\t\t\t\t  ]\n\tfor i in range(len(output_files_list)):\n\t\tfilename = output_files_list[i]\n\t\tif filename.endswith(".001.png"):\n\t\t\tos.remove(os.path.join(output_path, filename))\n\t\t\tcontinue\n\t\tif filename.endswith(".md"):\n\t\t\tif filename == "index.md":\n\t\t\t\tos.remove(os.path.join(output_path, filename))\n\t\t\t\tcontinue\n\t\t\twith open(os.path.join(output_path, filename), \'r\', encoding=\'UTF-8\') as f:\n\t\t\t\tcontent = f.read()\n\t\t\twith open(os.path.join(output_path, filename), \'w\', encoding=\'UTF-8\') as f:\n\t\t\t\tfor replace_list in replace_list_regex:\n\t\t\t\t\tcontent = re.sub(replace_list[0], replace_list[1], content)\n\t\t\t\t# f.write(content)\n\t\t\t\tlines = content.splitlines()\n\t\t\t\tfor line in lines:\n\t\t\t\t\tif len(line) > 4:\n\t\t\t\t\t\tfor file_mp4 in mp4_list:\n\t\t\t\t\t\t\tword_list = line.split(" ")\n\t\t\t\t\t\t\tflag = 0\n\t\t\t\t\t\t\tflag_out = 0\n\t\t\t\t\t\t\tfor word in word_list:\n\t\t\t\t\t\t\t\tif file_mp4.find(word) > -1:\n\t\t\t\t\t\t\t\t\tflag = flag+1\n\t\t\t\t\t\t\t\telif file_mp4.find(word) == -1:\n\t\t\t\t\t\t\t\t\tflag_out = flag_out+1\n\t\t\t\t\t\t\tif flag:\n\t\t\t\t\t\t\t\tif flag_out:\n\t\t\t\t\t\t\t\t\t# print(line)\n\t\t\t\t\t\t\t\t\tpass\n\t\t\t\t\t\t\t\telse:\n\t\t\t\t\t\t\t\t\tpath_mp4 = os.path.join(\n\t\t\t\t\t\t\t\t\t\tintput_path, file_mp4)\n\t\t\t\t\t\t\t\t\turl_path = urllib.parse.quote(\n\t\t\t\t\t\t\t\t\t\tos.path.abspath(path_mp4))\n\t\t\t\t\t\t\t\t\turl = "file:///" + \\\n\t\t\t\t\t\t\t\t\t\turl_path.replace("\\\\", "/")\n\t\t\t\t\t\t\t\t\tline = line+"\\n\\n" + \\\n\t\t\t\t\t\t\t\t\t\tf"[{file_mp4}]({url})\\n" + \\\n\t\t\t\t\t\t\t\t\t\tf"![{file_mp4}]({url})"\n\t\t\t\t\tf.write(line+"\\n")\n\tmd_note_process(output_path)\n\toutput_files_list = os.listdir(output_path)\n\toutput_path_md = output_path\n\toutput_path_img = os.path.join(\n\t\toutput_root, "imgs", output_folder_name, input_floder_name)\n\t# Create the output directory and its subdirectory if they don\'t exist\n\ttry:\n\t\tos.makedirs(output_path_img, exist_ok=True)\n\texcept FileNotFoundError as e:\n\t\tif e.winerror == 206:\n\t\t\t# Shorten the filename and try again\n\t\t\toutput_path_img = output_path_img = os.path.join(\n\t\t\t\toutput_path_md, "imgs")\n\t\t\tos.makedirs(output_path_img, exist_ok=True)\n\t\telse:\n\t\t\t# If it\'s not WinError 206, raise the original error\n\t\t\traise e\n\tfor i in range(len(output_files_list)):\n\t\tfilename = output_files_list[i]\n\t\tif filename.endswith(".md"):\n\t\t\ttry:\n\t\t\t\tos.replace(os.path.join(output_path, filename),\n\t\t\t\t\t\t   os.path.join(output_path_md, filename))\n\t\t\texcept FileExistsError:\n\t\t\t\tos.remove(os.path.join(output_path_md, filename))\n\t\t\t\tos.replace(os.path.join(output_path, filename),\n\t\t\t\t\t\t   os.path.join(output_path_md, filename))\n\t\tif filename.endswith(".png") or filename.endswith(".jpg") or filename.endswith(".jpeg") or filename.endswith(".gif"):\n\t\t\tfilename_ext = os.path.splitext(filename)[1]\n\t\t\tfilename_without_ext = os.path.splitext(filename)[0]\n\t\t\tfilename_img = filename_without_ext+f\'_{timestamp}\'+filename_ext\n\t\t\ttry:\n\t\t\t\tos.replace(os.path.join(output_path, filename),\n\t\t\t\t\t\t   os.path.join(output_path_img, filename_img))\n\t\t\texcept FileExistsError:\n\t\t\t\tos.remove(os.path.join(output_path_img, filename_img))\n\t\t\t\tos.replace(os.path.join(output_path, filename),\n\t\t\t\t\t\t   os.path.join(output_path_img, filename_img))\n\t\t\texcept FileNotFoundError as e:\n\t\t\t\tif e.winerror == 3:\n\t\t\t\t\toutput_path_img = output_path_img = os.path.join(\n\t\t\t\t\t\toutput_path_md, "imgs")\n\t\t\t\t\tos.makedirs(output_path_img, exist_ok=True)\n\t\t\t\t\tos.replace(os.path.join(output_path, filename),\n\t\t\t\t\t\t\t   os.path.join(output_path_img, filename_img))\n\t\t\t\telse:\n\t\t\t\t\t# If it\'s not WinError 206, raise the original error\n\t\t\t\t\traise e\ndef html2md2():\n\timport html2markdown\n\tfiles = [f for f in os.listdir() if os.path.isfile(f)]\n\tfor file in files:\n\t\tif file.endswith(".html"):\n\t\t\twith open(file, \'r\', encoding=\'utf-8\') as f:\n\t\t\t\thtml_string = f.read()\n\t\t\tmarkdown_text = html2markdown.convert(html_string)\n\t\t\twith open(file[:-4] + \'.md\', \'w\', encoding=\'utf-8\') as f:\n\t\t\t\tf.write(markdown_text)\ndef html2md_tree():\n\tfiles = [f for f in os.listdir() if os.path.isfile(f)]\n\tdirectories = [f for f in os.listdir() if os.path.isdir(f)]\n\toutput_folder_dict = dict()\n\tfor directory in directories:\n\t\tsearch_str = r\'Part (\\d{2})_(.+)\'\n\t\tmatch = re.search(search_str, directory)\n\t\tif match:\n\t\t\toutput_folder_dict[match.group(\n\t\t\t\t1)] = \'0\'+match.group(1)+"_"+match.group(2)\n\tfor directory in directories:\n\t\tsearch_str = r\'Part (\\d{2})-Module \\d{2}-Lesson (\\d{2})_(.+)\'\n\t\tmatch = re.search(search_str, directory)\n\t\tif match:\n\t\t\toutput_folder1 = "C:\\\\Output\\\\"\n\t\t\toutput_folder2 = output_folder_dict[match.group(1)]\n\t\t\t# output_folder=os.path.join(output_folder1,output_folder2)\n\t\t\tinput_path = os.path.join(os.getcwd(), directory)\n\t\t\thtml2md(input_path, output_folder1, output_folder2)\n'",
